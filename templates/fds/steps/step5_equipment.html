<fieldset class="form-step" id="step-5">
  <div class="step-header">
    <h1 class="step-legend">
      <i class="fas fa-project-diagram"></i>
      Step 5 - Version & System Overview
    </h1>
  </div>

  <div class="data-card">
    <div class="card-header">
      <span>Document Version Control</span>
    </div>
    <div class="card-body">
      <div class="table-container">
        <table>
          <thead>
            <tr>
              <th>Revision Number</th>
              <th>Details</th>
              <th>Date</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody id="version-history-body">
            {% if submission_data.VERSION_HISTORY %}
              {% for row in submission_data.VERSION_HISTORY %}
              <tr>
                <td><input name="version_revision[]" value="{{ row.Revision }}"/></td>
                <td><input name="version_details[]" value="{{ row.Details }}"/></td>
                <td><input name="version_date[]" type="date" value="{{ row.Date }}"/></td>
                <td><button type="button" class="btn-remove" onclick="removeRow(this)"><i class="fas fa-trash"></i></button></td>
              </tr>
              {% endfor %}
            {% else %}
              <tr>
                <td><input name="version_revision[]" placeholder="R0"/></td>
                <td><input name="version_details[]" placeholder="Initial Document"/></td>
                <td><input name="version_date[]" type="date"/></td>
                <td><button type="button" class="btn-remove" onclick="removeRow(this)"><i class="fas fa-trash"></i></button></td>
              </tr>
            {% endif %}
          </tbody>
        </table>
      </div>
      <button type="button" class="btn btn-add" onclick="addRow('tmpl-version-history', 'version-history-body')">
        <i class="fas fa-plus"></i> Add Revision
      </button>
    </div>
  </div>

  <div class="form-section">
    <h4><i class="fas fa-lightbulb"></i> System Overview and Purpose</h4>
    <div class="form-group">
      <label for="system_overview">System Overview</label>
      <textarea id="system_overview" name="system_overview"
        placeholder="Describe the system, architecture and overall context.">{{ submission_data.SYSTEM_OVERVIEW }}</textarea>
    </div>
    <div class="form-group">
      <label for="system_purpose">System Purpose</label>
      <textarea id="system_purpose" name="system_purpose"
        placeholder="Outline the objectives and business outcomes">{{ submission_data.SYSTEM_PURPOSE }}</textarea>
    </div>
  </div>

  <div class="form-section">
    <h4><i class="fas fa-tasks"></i> Scope of Work</h4>
    <div class="form-group">
      <label for="scope_of_work">Scope Definition</label>
      <textarea id="scope_of_work" name="scope_of_work"
        placeholder="List included subsystems, locations, constraints and exclusions">{{ submission_data.SCOPE_OF_WORK }}</textarea>
    </div>
  </div>

  <div class="form-section">
    <h4><i class="fas fa-list-alt"></i> Functional Requirements & Control Philosophy</h4>
    <div class="form-group">
      <label for="functional_requirements">Functional Requirements</label>
      <textarea id="functional_requirements" name="functional_requirements"
        placeholder="Detail the functional behaviour expected from the control system">{{ submission_data.FUNCTIONAL_REQUIREMENTS }}</textarea>
    </div>
    <div class="form-group">
      <label for="process_description">Process Description</label>
      <textarea id="process_description" name="process_description"
        placeholder="Describe the process flow supported by this automation">{{ submission_data.PROCESS_DESCRIPTION }}</textarea>
    </div>
    <div class="form-group">
      <label for="control_philosophy">Control Philosophy</label>
      <textarea id="control_philosophy" name="control_philosophy"
        placeholder="Document the control strategy, sequences and interlocks">{{ submission_data.CONTROL_PHILOSOPHY }}</textarea>
    </div>
  </div>

  <div class="form-section">
    <h4><i class="fas fa-lock"></i> Confidentiality Notice</h4>
    <div class="confidentiality-box">
      <p>
        This document contains confidential and proprietary information of Cully. Unauthorized distribution
        or reproduction is strictly prohibited. Please ensure this notice accompanies the final FDS output.
      </p>
    </div>
    <div class="form-group" style="margin-top:16px;">
      <label for="confidentiality_notice">Custom Confidentiality Statement (optional)</label>
      <textarea id="confidentiality_notice" name="confidentiality_notice"
        placeholder="Enter an additional notice if required.">{{ submission_data.CONFIDENTIALITY_NOTICE }}</textarea>
    </div>
  </div>

  <div class="btn-group">
    <button type="button" class="btn btn-secondary" onclick="goToStep(4)">
      <i class="fas fa-arrow-left"></i> Previous
    </button>
    <button type="button" class="btn btn-primary" onclick="goToStep(6)">
      <i class="fas fa-arrow-right"></i> Next Step
    </button>
  </div>
</fieldset>
