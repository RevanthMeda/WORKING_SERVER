<fieldset class="form-step" id="step-2">
  <div class="step-header">
    <h1 class="step-legend">
      <i class="fas fa-users"></i>
      Step 2 â€” Approvals & Workflow
    </h1>
  </div>

  <div class="form-section">
    <h4><i class="fas fa-user-check"></i> Approval Personnel</h4>

    <div class="form-row">
      <div class="form-group">
        <label for="prepared_by">Prepared By</label>
        <input
          id="prepared_by"
          name="prepared_by_name"
          type="text"
          readonly
          value="{{ submission_data.PREPARED_BY_NAME or (current_user.full_name if current_user.is_authenticated else '') }}"
          style="background-color: #f8fafc; cursor: not-allowed;"
        />
      </div>

      <div class="form-group">
        <label for="reviewed_by_tech_lead">Reviewed by (Automation Manager)</label>
        <input
          type="text"
          id="reviewed_by_tech_lead"
          name="reviewer1_name"
          readonly
          value="{{ submission_data.get('REVIEWER1_NAME', '') }}"
          placeholder="Will auto-populate from selection below"
          style="background-color: #f8fafc; cursor: not-allowed;"
        />
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label for="reviewed_by_pm">Reviewed By PM</label>
        <input
          id="reviewed_by_pm"
          name="reviewer2_name"
          type="text"
          readonly
          value="{{ submission_data.get('REVIEWER2_NAME', '') }}"
          placeholder="Will auto-populate from selection below"
          style="background-color: #f8fafc; cursor: not-allowed;"
        />
      </div>

      <div class="form-group">
        <label for="approved_by_client">Approved By Client</label>
        <input
          id="approved_by_client"
          name="client_approval_name"
          type="text"
          value="{{ submission_data.CLIENT_APPROVAL_NAME }}"
        />
      </div>
    </div>
  </div>

  <div class="data-card">
    <div class="card-header">Approval Workflow</div>
    <div class="card-body">
      <p style="margin-bottom: 20px; color: var(--text-secondary);">
        Select the people who will approve this report. Names and email addresses will be auto-populated.
      </p>

      <div class="form-row">
        <div class="form-group">
          <label for="approver_1_name_select"><i class="fas fa-user-cog"></i> Automation Manager Name</label>
          <select id="approver_1_name_select" name="approver_1_name_select">
            <option value="">Select Automation Manager...</option>
          </select>
          <input type="hidden" name="approver_1_name" id="approver_1_name" value="{{ submission_data.get('approver_1_name', '') }}"/>
          <input type="hidden" name="approver_1_email" id="approver_1_email" value="{{ submission_data.get('approver_1_email', '') }}"/>
          <label for="approver_1_email_display" style="margin-top: 8px;">Email Address</label>
          <input
            type="email"
            id="approver_1_email_display"
            readonly
            placeholder="Email will auto-populate when name is selected"
            style="background-color: #f8fafc; cursor: not-allowed;"
          />
        </div>

        <div class="form-group">
          <label for="approver_2_name_select"><i class="fas fa-user"></i> Project Manager Name</label>
          <select id="approver_2_name_select" name="approver_2_name_select">
            <option value="">Select Project Manager...</option>
          </select>
          <input type="hidden" name="approver_2_name" id="approver_2_name" value="{{ submission_data.get('approver_2_name', '') }}"/>
          <input type="hidden" name="approver_2_email" id="approver_2_email" value="{{ submission_data.get('approver_2_email', '') }}"/>
          <label for="approver_2_email_display" style="margin-top: 8px;">Email Address</label>
          <input
            type="email"
            id="approver_2_email_display"
            readonly
            placeholder="Email will auto-populate when name is selected"
            style="background-color: #f8fafc; cursor: not-allowed;"
          />
        </div>
      </div>
    </div>
  </div>

  <input type="hidden" name="prepared_by_role" value="{{ submission_data.PREPARED_BY_ROLE or 'Automation Engineer' }}"/>
  <input type="hidden" name="prepared_by_date" value="{{ submission_data.PREPARED_BY_DATE }}"/>
  <input type="hidden" name="prepared_by_email" value="{{ submission_data.PREPARED_BY_EMAIL or (current_user.email if current_user.is_authenticated else '') }}"/>
  <input type="hidden" name="reviewer1_role" value="{{ submission_data.REVIEWER1_ROLE or 'Automation Manager' }}"/>
  <input type="hidden" name="reviewer1_date" value="{{ submission_data.REVIEWER1_DATE }}"/>
  <input type="hidden" name="reviewer1_email" id="reviewer1_email" value="{{ submission_data.REVIEWER1_EMAIL }}"/>
  <input type="hidden" name="reviewer2_role" value="{{ submission_data.REVIEWER2_ROLE or 'Project Manager' }}"/>
  <input type="hidden" name="reviewer2_date" value="{{ submission_data.REVIEWER2_DATE }}"/>
  <input type="hidden" name="reviewer2_email" id="reviewer2_email" value="{{ submission_data.REVIEWER2_EMAIL }}"/>
  <input type="hidden" name="client_approval_date" value="{{ submission_data.CLIENT_APPROVAL_DATE }}"/>
  <input type="hidden" name="client_approval_email" value="{{ submission_data.CLIENT_APPROVAL_EMAIL }}"/>

  <div class="btn-group">
    <button type="button" class="btn btn-secondary" onclick="goToStep(1)">
      <i class="fas fa-arrow-left"></i> Previous
    </button>
    <button type="button" class="btn btn-primary" onclick="goToStep(3)">
      Next Step <i class="fas fa-arrow-right"></i>
    </button>
  </div>
</fieldset>
