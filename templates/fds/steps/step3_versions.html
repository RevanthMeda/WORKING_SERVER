<fieldset class="form-step" id="step-3">
  <div class="step-header">
    <h1 class="step-legend">
      <i class="fas fa-bullseye"></i>
      Step 3 &mdash; Purpose &amp; Scope
    </h1>
  </div>

  <div class="form-section">
    <div class="form-row">
      <div class="form-group">
        <label for="purpose">Purpose</label>
        <div class="ai-helper">
          <button type="button" class="ai-suggest-btn" data-field="purpose"><i class="fas fa-magic"></i> Ask AI</button>
          <span class="ai-feedback" data-field="purpose"></span>
        </div>
        <div class="rich-text-container">
          <div class="formatting-toolbar" data-target="purpose-editor">
            <div class="toolbar-group">
              <button type="button" class="toolbar-btn" data-command="bold" title="Bold (Ctrl+B)">
                <i class="fas fa-bold"></i>
              </button>
              <button type="button" class="toolbar-btn" data-command="italic" title="Italic (Ctrl+I)">
                <i class="fas fa-italic"></i>
              </button>
              <button type="button" class="toolbar-btn" data-command="underline" title="Underline (Ctrl+U)">
                <i class="fas fa-underline"></i>
              </button>
              <button type="button" class="toolbar-btn" data-command="strikeThrough" title="Strikethrough">
                <i class="fas fa-strikethrough"></i>
              </button>
            </div>
            <div class="toolbar-group">
              <button type="button" class="toolbar-btn" data-command="justifyLeft" title="Align Left">
                <i class="fas fa-align-left"></i>
              </button>
              <button type="button" class="toolbar-btn" data-command="justifyCenter" title="Align Center">
                <i class="fas fa-align-center"></i>
              </button>
              <button type="button" class="toolbar-btn" data-command="justifyRight" title="Align Right">
                <i class="fas fa-align-right"></i>
              </button>
              <button type="button" class="toolbar-btn" data-command="justifyFull" title="Justify">
                <i class="fas fa-align-justify"></i>
              </button>
            </div>
            <div class="toolbar-group">
              <button type="button" class="toolbar-btn" data-command="insertUnorderedList" title="Bullet List">
                <i class="fas fa-list-ul"></i>
              </button>
              <button type="button" class="toolbar-btn" data-command="insertOrderedList" title="Numbered List">
                <i class="fas fa-list-ol"></i>
              </button>
              <button type="button" class="toolbar-btn" data-command="indent" title="Increase Indent">
                <i class="fas fa-indent"></i>
              </button>
              <button type="button" class="toolbar-btn" data-command="outdent" title="Decrease Indent">
                <i class="fas fa-outdent"></i>
              </button>
            </div>
            <div class="toolbar-group">
              <button type="button" class="toolbar-btn" data-command="formatBlock" data-value="h1" title="Heading 1">
                H1
              </button>
              <button type="button" class="toolbar-btn" data-command="formatBlock" data-value="h2" title="Heading 2">
                H2
              </button>
              <button type="button" class="toolbar-btn" data-command="formatBlock" data-value="h3" title="Heading 3">
                H3
              </button>
              <button type="button" class="toolbar-btn" data-command="formatBlock" data-value="p" title="Paragraph">
                <i class="fas fa-paragraph"></i>
              </button>
            </div>
            <div class="toolbar-group">
              <button type="button" class="toolbar-btn" data-command="foreColor" data-value="#000000" title="Text Color">
                <i class="fas fa-palette"></i>
              </button>
              <input type="color" class="color-picker" data-command="foreColor" title="Choose Text Color" value="#1f2937">
              <button type="button" class="toolbar-btn" data-command="hiliteColor" data-value="#ffff00" title="Highlight">
                <i class="fas fa-highlighter"></i>
              </button>
              <input type="color" class="color-picker" data-command="hiliteColor" title="Choose Highlight Color" value="#ffff00">
            </div>
            <div class="toolbar-group">
              <button type="button" class="toolbar-btn" data-command="removeFormat" title="Clear Formatting">
                <i class="fas fa-remove-format"></i>
              </button>
              <button type="button" class="toolbar-btn" data-command="selectAll" title="Select All (Ctrl+A)">
                <i class="fas fa-select-all"></i>
              </button>
            </div>
          </div>
          <div id="purpose-editor" class="rich-text-editor" contenteditable="true"
               data-placeholder="Describe the purpose of this SAT report...">{{ submission_data.PURPOSE }}</div>
          <textarea id="purpose" name="purpose" style="display: none;">{{ submission_data.PURPOSE }}</textarea>
        </div>
      </div>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label for="scope">Scope</label>
        <div class="ai-helper">
          <button type="button" class="ai-suggest-btn" data-field="scope"><i class="fas fa-magic"></i> Ask AI</button>
          <span class="ai-feedback" data-field="scope"></span>
        </div>
        <div class="rich-text-container">
          <div class="formatting-toolbar" data-target="scope-editor">
            <div class="toolbar-group">
              <button type="button" class="toolbar-btn" data-command="bold" title="Bold (Ctrl+B)">
                <i class="fas fa-bold"></i>
              </button>
              <button type="button" class="toolbar-btn" data-command="italic" title="Italic (Ctrl+I)">
                <i class="fas fa-italic"></i>
              </button>
              <button type="button" class="toolbar-btn" data-command="underline" title="Underline (Ctrl+U)">
                <i class="fas fa-underline"></i>
              </button>
              <button type="button" class="toolbar-btn" data-command="strikeThrough" title="Strikethrough">
                <i class="fas fa-strikethrough"></i>
              </button>
            </div>
            <div class="toolbar-group">
              <button type="button" class="toolbar-btn" data-command="justifyLeft" title="Align Left">
                <i class="fas fa-align-left"></i>
              </button>
              <button type="button" class="toolbar-btn" data-command="justifyCenter" title="Align Center">
                <i class="fas fa-align-center"></i>
              </button>
              <button type="button" class="toolbar-btn" data-command="justifyRight" title="Align Right">
                <i class="fas fa-align-right"></i>
              </button>
              <button type="button" class="toolbar-btn" data-command="justifyFull" title="Justify">
                <i class="fas fa-align-justify"></i>
              </button>
            </div>
            <div class="toolbar-group">
              <button type="button" class="toolbar-btn" data-command="insertUnorderedList" title="Bullet List">
                <i class="fas fa-list-ul"></i>
              </button>
              <button type="button" class="toolbar-btn" data-command="insertOrderedList" title="Numbered List">
                <i class="fas fa-list-ol"></i>
              </button>
              <button type="button" class="toolbar-btn" data-command="indent" title="Increase Indent">
                <i class="fas fa-indent"></i>
              </button>
              <button type="button" class="toolbar-btn" data-command="outdent" title="Decrease Indent">
                <i class="fas fa-outdent"></i>
              </button>
            </div>
            <div class="toolbar-group">
              <button type="button" class="toolbar-btn" data-command="formatBlock" data-value="h1" title="Heading 1">
                H1
              </button>
              <button type="button" class="toolbar-btn" data-command="formatBlock" data-value="h2" title="Heading 2">
                H2
              </button>
              <button type="button" class="toolbar-btn" data-command="formatBlock" data-value="h3" title="Heading 3">
                H3
              </button>
              <button type="button" class="toolbar-btn" data-command="formatBlock" data-value="p" title="Paragraph">
                <i class="fas fa-paragraph"></i>
              </button>
            </div>
            <div class="toolbar-group">
              <button type="button" class="toolbar-btn" data-command="foreColor" data-value="#000000" title="Text Color">
                <i class="fas fa-palette"></i>
              </button>
              <input type="color" class="color-picker" data-command="foreColor" title="Choose Text Color" value="#1f2937">
              <button type="button" class="toolbar-btn" data-command="hiliteColor" data-value="#ffff00" title="Highlight">
                <i class="fas fa-highlighter"></i>
              </button>
              <input type="color" class="color-picker" data-command="hiliteColor" title="Choose Highlight Color" value="#ffff00">
            </div>
            <div class="toolbar-group">
              <button type="button" class="toolbar-btn" data-command="removeFormat" title="Clear Formatting">
                <i class="fas fa-remove-format"></i>
              </button>
              <button type="button" class="toolbar-btn" data-command="selectAll" title="Select All (Ctrl+A)">
                <i class="fas fa-select-all"></i>
              </button>
            </div>
          </div>
          <div id="scope-editor" class="rich-text-editor" contenteditable="true"
               data-placeholder="Define the scope of testing...">{{ submission_data.SCOPE }}</div>
          <textarea id="scope" name="scope" style="display: none;">{{ submission_data.SCOPE }}</textarea>
        </div>
      </div>
    </div>
  </div>

  <div class="btn-group">
    <button type="button" class="btn btn-secondary" onclick="goToStep(2)">
      <i class="fas fa-arrow-left"></i> Previous
    </button>
    <button type="button" class="btn btn-primary" onclick="goToStep(4)">
      Next Step <i class="fas fa-arrow-right"></i>
    </button>
  </div>
</fieldset>
